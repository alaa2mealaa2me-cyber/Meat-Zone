<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø­Ø±ÙˆÙ Ø§Ù„Ø°ÙƒÙŠ</title>

<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@600;700&display=swap" rel="stylesheet">

<style>
body{
  margin:0;
  background:#f7f9fb;
  font-family:'Cairo',sans-serif;
}

#aiBot{
  position:fixed;
  top:20px;
  right:20px;
  width:340px;
  height:560px;
  background:#ffffff;
  border-radius:25px;
  box-shadow:0 8px 22px rgba(0,0,0,.25);
  display:flex;
  flex-direction:column;
}

#aiHeader{
  background:#1E8449;
  color:#fff;
  padding:16px;
  text-align:center;
  font-size:18px;
  border-radius:25px 25px 0 0;
}

#messages{
  flex:1;
  padding:12px;
  overflow-y:auto;
  font-size:15px;
}

.msg{
  background:#eef3ff;
  padding:10px;
  border-radius:14px;
  margin-bottom:8px;
}

#controls{
  display:flex;
  gap:6px;
  padding:12px;
}

#controls input{
  flex:1;
  padding:10px;
  border-radius:12px;
  border:1px solid #ccc;
  font-size:14px;
}

#controls button{
  border:none;
  border-radius:12px;
  padding:10px 12px;
  cursor:pointer;
  font-size:16px;
}

#micBtn{
  background:#D4EFDF;
}

#sendBtn{
  background:#AED6F1;
}
</style>
</head>

<body>

<div id="aiBot">
  <div id="aiHeader">ğŸ¤– Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø­Ø±ÙˆÙ Ø§Ù„Ø°ÙƒÙŠ</div>

  <div id="messages">
    <div class="msg">ğŸ‘‹ Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ ğŸ¤ ÙˆØªÙƒÙ„Ù… Ø£Ùˆ Ø§ÙƒØªØ¨ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©</div>
  </div>

  <div id="controls">
    <button id="micBtn" onclick="startMic()">ğŸ¤</button>
    <input id="textInput" placeholder="Ù‚Ù„ Ø£Ùˆ Ø§ÙƒØªØ¨ Ø§Ù„ÙƒÙ„Ù…Ø©">
    <button id="sendBtn" onclick="processInput()">â¡</button>
  </div>
</div>

<script>
/* ===============================
   ğŸ§  Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©
================================ */
const letterRules = {
  "Ø«": ["Ø«Ø¹Ù„Ø¨"],
  "Ø­": ["Ø­ØµØ§Ù†"],
  "Ø¸": ["Ø¸Ø±Ù"],
  "Ø¨": ["Ø¨Ø·Ø©"],
  "Øª": ["ØªÙØ§Ø­Ø©"],
  "Ø´": ["Ø´Ù…Ø³"],
  "Ø·": ["Ø·Ø±ÙŠÙ‚"],
  "Ù…": ["Ù…ÙˆØ²"],
  "Ø²": ["Ø²Ø±Ø§ÙØ©"],
  "Ø°": ["Ø°Ø¨Ø§Ø¨"],
  "Ø¯": ["Ø¯Ø¨"],
  "Ù†": ["Ù†Ù…Ø±"],
  "Ø³": ["Ø³ÙŠØ§Ø±Ø©"]
};

/* ğŸ”¤ Ø§Ù„Ø­Ø±Ù Ø§Ù„Ø­Ø§Ù„ÙŠ (ØºÙŠÙ‘Ø±Ù‡ Ù…Ù† ØµÙØ­ØªÙƒ) */
let currentLetter = "Ø«";

/* ===============================
   ğŸ¤ Ø§Ù„Ù…Ø§ÙŠÙƒ (Ù…ØµÙØ­Ù‘ÙØ­ 100%)
================================ */
function startMic(){

  const SpeechRecognition =
    window.SpeechRecognition || window.webkitSpeechRecognition;

  if (!SpeechRecognition) {
    addMsg("âŒ Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø§Ù„Ù…Ø§ÙŠÙƒ. Ø§Ø³ØªØ®Ø¯Ù… Chrome Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ±.");
    speak("Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø§Ù„Ù…Ø§ÙŠÙƒ");
    return;
  }

  const recognition = new SpeechRecognition();
  recognition.lang = "ar-SA";
  recognition.interimResults = false;
  recognition.maxAlternatives = 1;

  recognition.onstart = () => {
    addMsg("ğŸ¤ Ø£Ø³ØªÙ…Ø¹ Ø¥Ù„ÙŠÙƒ Ø§Ù„Ø¢Ù†...");
  };

  recognition.onresult = (event) => {
    const text = event.results[0][0].transcript;
    document.getElementById("textInput").value = text;
    processInput();
  };

  recognition.onerror = (event) => {
    addMsg("âŒ Ù„Ù… Ø£Ø³Ù…Ø¹Ùƒ Ø¬ÙŠØ¯Ù‹Ø§ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰");
    speak("Ù„Ù… Ø£Ø³Ù…Ø¹Ùƒ Ø¬ÙŠØ¯Ù‹Ø§ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰");
    console.error(event.error);
  };

  recognition.start();
}

/* ===============================
   ğŸ§  ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©
================================ */
function processInput(){
  const input = document.getElementById("textInput");
  const text = input.value.trim();
  if(!text) return;

  addMsg("ğŸ§’ " + text);

  const correctWords = letterRules[currentLetter] || [];
  let reply = "";

  if(correctWords.includes(text)){
    reply = "Ø±Ø§Ø¦Ø¹ Ø¬Ø¯Ù‹Ø§! Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©ØŒ Ø£Ø­Ø³Ù†Øª ÙŠØ§ Ø¨Ø·Ù„!";
  }else{
    reply = "Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.";
  }

  addMsg("ğŸ¤– " + reply);
  speak(reply);
  input.value = "";
}

/* ===============================
   ğŸ’¬ Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
================================ */
function addMsg(msg){
  const box = document.getElementById("messages");
  const div = document.createElement("div");
  div.className = "msg";
  div.innerText = msg;
  box.appendChild(div);
  box.scrollTop = box.scrollHeight;
}

/* ===============================
   ğŸ”Š Ø§Ù„Ø±Ø¯ Ø¨Ø§Ù„ØµÙˆØª
================================ */
function speak(text){
  const u = new SpeechSynthesisUtterance(text);
  u.lang = "ar-SA";
  speechSynthesis.speak(u);
}

/* ===============================
   ğŸ”— Ø±Ø¨Ø· Ù…Ø¹ ØµÙØ­ØªÙƒ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©
================================ */
window.setCurrentLetter = function(letter){
  currentLetter = letter;
};
</script>

</body>
</html>
